<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Functions to compute various characteristics of a PCARMA model — pcarma_solve • pcts</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Functions to compute various characteristics of a PCARMA model — pcarma_solve"><meta property="og:description" content="

Given a PCARMA model, create a function for computing autocovariances
  or coefficients of the corresponding infinite moving average
  representation or prepare the linear system whose solution provides
  the first few autocovariances of the model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pcts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.15.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/pcts_data.html">Importing and manipulating periodic time series data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/GeoBosh/pcts/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Functions to compute various characteristics of a PCARMA model</h1>
    
    <div class="hidden name"><code>pcarma_solve.Rd</code></div>
    </div>

    <div class="ref-description">
    

<p>Given a PCARMA model, create a function for computing autocovariances
  or coefficients of the corresponding infinite moving average
  representation or prepare the linear system whose solution provides
  the first few autocovariances of the model.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">pcarma_acvf_lazy</span><span class="op">(</span><span class="va">phi</span>, <span class="va">theta</span>, <span class="va">sigma2</span>, <span class="va">p</span>, <span class="va">q</span>, <span class="va">period</span>, maxlag <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu">pcarma_h_lazy</span><span class="op">(</span><span class="va">phi</span>, <span class="va">theta</span>, <span class="va">p</span>, <span class="va">q</span>, <span class="va">period</span>, maxlag <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="fu">pcarma_acvf_system</span><span class="op">(</span><span class="va">phi</span>, <span class="va">theta</span>, <span class="va">sigma2</span>, <span class="va">p</span>, <span class="va">q</span>, <span class="va">period</span><span class="op">)</span>
<span class="fu">pcarma_param_system</span><span class="op">(</span><span class="va">acf</span>, <span class="va">h</span>, <span class="va">sigma2</span>, <span class="va">p</span>, <span class="va">q</span>, <span class="va">period</span><span class="op">)</span>
<span class="fu">pcarma_h</span><span class="op">(</span><span class="va">h</span>, na <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>phi</dt>
<dd><p>the autoregression parameters, an object of class <code>"slMatrix"</code></p></dd>
<dt>theta</dt>
<dd><p>the moving average parameters, an object of class <code>"slMatrix"</code></p></dd>
<dt>sigma2</dt>
<dd><p>the innovation variances, an object of class
    <code>"PeriodicVector"</code> or  a vector of size <code>period</code>, Details.</p></dd>
<dt>p</dt>
<dd><p>the (maximal) autoregression order or the autoregression orders.</p></dd>
<dt>q</dt>
<dd><p>the (maximal) moving average order or the moving average orders.</p></dd>
<dt>period</dt>
<dd><p>number of seasons in an epoch</p></dd>
<dt>maxlag</dt>
<dd><p>maximal lag for which the result is stored internally.</p></dd>
<dt>acf</dt>
<dd><p>the autocovariance function, an object of class pcAcvf,
    slMatrix, or similar</p></dd>
<dt>h</dt>
<dd><p><code>pcarma_param_system</code>,
    <code>h(t,k)</code>  is expected to return the coefficient
    \(h_{t,k}\). <code>h</code> is usually created by
    <code>pcarma_h_lazy</code>.
    For <code>pcarma_h</code>,  a matrix of h(t,i) coefficients.</p></dd>
<dt>na</dt>
<dd><p>not used currently, controls what to do for large lags.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    

<p></p><div class="section">
<h3 id="compute-acvf-from-parameters">Compute acvf from parameters<a class="anchor" aria-label="anchor" href="#compute-acvf-from-parameters"></a></h3>


<p><code>pcarma_acvf_lazy</code> creates a function that will compute (on
    demand) values of the acf by a recursive formula. Computed values
    are stored internally for lags up to <code>maxlag</code>.</p>
<p></p>
</div>

<p></p><div class="section">
<h3 id="system-for-acvf-from-parameters">System for acvf from parameters<a class="anchor" aria-label="anchor" href="#system-for-acvf-from-parameters"></a></h3>


<p><code>pcarma_acvf_system</code> forms a linear system for the calculation
    of autocovariances from the parameters of a pc-arma model.  The
    argument <code>theta</code> is not used if \(q=0\) and <code>phi</code> is not
    used if \(p=0\).</p>
<p></p>
</div>

<p></p><div class="section">
<h3 id="system-for-parameters-from-acvf">System for parameters from acvf<a class="anchor" aria-label="anchor" href="#system-for-parameters-from-acvf"></a></h3>
<p><code>pcarma_param_system</code> takes
    the periodic autocovariances of a pc-arma model and computes a
    matrix and a vector representing the linear system whose solution
    provides the parameters of the model.</p>
<p>Scalar <code>p</code> specifies the same autoregression order for each
    season, similarly for <code>q</code>.  <code>p</code> and <code>q</code> may be
    vectors of length <code>period</code> specifying the order for each season
    individually. In the latter case the solution of the system may not
    be a proper model or, if it is, its autocovariances may not be the
    ones used here! See the references for details.</p>
<p>The class of <code>acf</code> is not required to be one of those
    explicitly listed above, but it should understand their indexing
    conventions, similarly for <code>sigma2</code>.</p>
<p>For pure autoregression, \(q=0\), the arguments <code>h</code> and
    <code>sigma2</code> are ignored. <strong>TODO: add sigma2 (if supplied) to
    the returned list?</strong></p>
</div>

<p></p><div class="section">
<h3 id="compute-h-from-parameters">Compute h from parameters<a class="anchor" aria-label="anchor" href="#compute-h-from-parameters"></a></h3>


<p><code>pcarma_h_lazy</code>: h(t,i) are the coefficients in infinite the
    moving average representation of the pc.arma model. The calculations
    use formula (4.4) from my paper (or elsewhere) with internal storage
    (in an slMatrix) of calculated results (for i&lt;maxlag) and recursive
    calls to itself. So, it is not necessary to compute h(t,i) in any
    particular order.</p>
<p></p>
</div>

<p></p><div class="section">
<h3 id="infinite-ma-coefficients-h-">Infinite MA coefficients(h)<a class="anchor" aria-label="anchor" href="#infinite-ma-coefficients-h-"></a></h3>


<p><code>pcarma_h</code> Function to create a function for lazy computation
    of h(t,i) in pc.arma models</p>
<p>Takes a matrix of h(t,i) coefficeints and returns a function that
    calculates h(t,i) from my paper xxx. The returned value can be used
    in the same way as that of <code>pcarma_h_lazy</code>.</p>
<p></p>
</div>


    </div>
    <div id="value">
    <h2>Value</h2>
    <div class="section">
<h3 id="for-pcarma-acvf-lazy">for pcarma_acvf_lazy<a class="anchor" aria-label="anchor" href="#for-pcarma-acvf-lazy"></a></h3>


<p>a function taking two arguments <code>t</code> and <code>k</code> such that for
    scalar <code>t</code> and <code>k</code> the call <code>f(t,k)</code> will return
    EX(t)X(t-k). If either of the arguments is a vector, then
    <code>f(t,k)</code> returns a matrix of size (<code>length(t),length(k)</code>)
    containing the respective autocovariances.</p>
<p></p>
</div><div class="section">
<h3 id="for-pcarma-h-lazy">for pcarma_h_lazy<a class="anchor" aria-label="anchor" href="#for-pcarma-h-lazy"></a></h3>


<p>a function, say <code>h</code>. In calls to <code>h</code>, if both arguments
    are scalars <code>h(t,i)</code> returns $h_t,i$. If at least one of the
    arguments is a vector a matrix of values of $h$ is returned.</p>
<p></p>
</div><div class="section">
<h3 id="for-pcarma-acvf-system">for pcarma_acvf_system<a class="anchor" aria-label="anchor" href="#for-pcarma-acvf-system"></a></h3>


<p>a list with two components representing the linear system:</p><dl><dt>A</dt>
<dd><p>The
	\((p+1)\mbox{period}\times(p+1)\mbox{period}\)
	matrix of the system, an object of class "matrix".</p></dd>

      <dt>b</dt>
<dd><p>The right-hand side of the system,  a vector of length
	\((p+1)\mbox{period}\), an object of class "vector".</p></dd>

    
</dl><p>\(A^{-1}b\) can be used to get a vector of the
    autocovariances in the following order (d is the period, p is the
    maximal AR order):
    $$K(1,0),...,K(d,0), K(1,1),...,K(d,1),...,K(1,p),...,K(d,p).$$</p>
<p></p>
</div><div class="section">
<h3 id="for-pcarma-param-system">for pcarma_param_system<a class="anchor" aria-label="anchor" href="#for-pcarma-param-system"></a></h3>


<p>A list with components representing the linear system and the AR and
    MA orders:</p><dl><dt>A</dt>
<dd><p>The matrix of the system</p></dd>

      <dt>b</dt>
<dd><p>The right-hand side of the system</p></dd>

      <dt>p</dt>
<dd><p>The AR order</p></dd>

      <dt>q</dt>
<dd><p>The MA order</p></dd>

    
</dl><p>\(A^{-1}b\) will return a vector of the parameters of the
    pc-arma model: all parameters for the first season, followed by all
    parameters for the second seasons and so on. For each season the
    parameters are in the following order (s is the current season, d is
    the period, \(p[s]\) and \(q[s]\) are the corresponding AR and
    MA orders):
    $$
      \sigma^2(s), \phi(s,1),...,\phi(s,p[s]),\theta(s,1),...,\theta(s,q[s]).
    $$</p>
</div><div class="section">
<h3 id="for-pcarma-h">for pcarma_h<a class="anchor" aria-label="anchor" href="#for-pcarma-h"></a></h3>


<p>a function, say <code>h</code>. In calls to <code>h</code>, if both arguments
    are scalars <code>h(t,i)</code> returns $h_t,i$. If at least one of the
    arguments is a vector a matrix of values of $h$ is returned.
    Analogous to <code>pcarma_h_lazy</code>.</p>
<p></p>
</div>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Boshnakov GN (1996).
“Recursive computation of the parameters of periodic autoregressive moving-average processes.”
<em>J. Time Ser. Anal.</em>, <b>17</b>(4), 333--349.
ISSN 0143-9782, doi: <a href="https://doi.org/10.1111/j.1467-9892.1996.tb00281.x" class="external-link">10.1111/j.1467-9892.1996.tb00281.x</a>
.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Georgi N. Boshnakov</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    

<p>for <code>pcarma_acvf_lazy</code>: The recursion may become extremely slow for lags greater than
  <code>maxlag</code>. If large lags are likely to be needed the argument
  <code>maxlag</code> should be used to increase the internal storage. The
  default for <code>maxlag</code> currently is 100.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><!-- % \code{\link{pcarma_h_lazy}} -->
  <code>pcarma_h</code>,
  <code>pcarma_param_system</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## periodic acf of Lambert-Lacroix</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ex1f</span><span class="op">)</span></span>
<span class="r-in"><span class="op">(</span><span class="va">pc3</span> <span class="op">&lt;-</span> <span class="fu"><a href="pcts_reexports.html">slMatrix</a></span><span class="op">(</span>period <span class="op">=</span> <span class="fl">2</span>, maxlag <span class="op">=</span> <span class="fl">5</span>, f <span class="op">=</span> <span class="va">ex1f</span>, type <span class="op">=</span> <span class="st">"tt"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class "slMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "m":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       lag</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> season 0    1     2     3      4      5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1 1 0.81 0.729 0.729 0.6561 0.6561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2 1 0.90 0.900 0.810 0.8100 0.7290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="co">## find the parameters</span></span>
<span class="r-in"><span class="va">s3</span> <span class="op">&lt;-</span> <span class="fu">pcarma_param_system</span><span class="op">(</span><span class="va">pc3</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">coef3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">s3</span><span class="op">$</span><span class="va">A</span>, <span class="va">s3</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="pc.modelunvec.html">pcarma_unvec</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">2</span>, q <span class="op">=</span> <span class="fl">0</span>, period <span class="op">=</span> <span class="fl">2</span>, param <span class="op">=</span> <span class="va">coef3</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $q</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $si2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3439000 0.1049724</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $phi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.8100000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.4972376 0.4972376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## actually, the model is PAR(1,2):</span></span>
<span class="r-in"><span class="va">s3a</span> <span class="op">&lt;-</span> <span class="fu">pcarma_param_system</span><span class="op">(</span><span class="va">pc3</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">coef3a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">s3a</span><span class="op">$</span><span class="va">A</span>, <span class="va">s3a</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="pc.modelunvec.html">pcarma_unvec</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, q <span class="op">=</span> <span class="fl">0</span>, period <span class="op">=</span> <span class="fl">2</span>, param <span class="op">=</span> <span class="va">coef3a</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $q</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $si2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3439000 0.1049724</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $phi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.8100000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.4972376 0.4972376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## prepare test parameters for a PAR(2) model with period=2.</span></span>
<span class="r-in"><span class="co">##   (rounded to 6 digits from the above example.</span></span>
<span class="r-in"><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.81</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.4972376</span>, <span class="fl">0.4972376</span><span class="op">)</span> <span class="op">)</span></span>
<span class="r-in"><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">)</span></span>
<span class="r-in"><span class="va">testphi</span> <span class="op">&lt;-</span> <span class="fu"><a href="pcts_reexports.html">slMatrix</a></span><span class="op">(</span>init <span class="op">=</span> <span class="va">m1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">testtheta</span> <span class="op">&lt;-</span> <span class="fu"><a href="pcts_reexports.html">slMatrix</a></span><span class="op">(</span>init <span class="op">=</span> <span class="va">m2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">si2</span> <span class="op">&lt;-</span> <span class="fu"><a href="PeriodicVector-class.html">PeriodicVector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3439000</span>, <span class="fl">0.1049724</span><span class="op">)</span><span class="op">)</span> <span class="co">#     # or si2 &lt;- c(1,1)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## acf from parameters</span></span>
<span class="r-in"><span class="va">myf</span> <span class="op">&lt;-</span> <span class="fu">pcarma_acvf_lazy</span><span class="op">(</span><span class="va">testphi</span>, <span class="va">testtheta</span>, <span class="va">si2</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">2</span>, maxlag <span class="op">=</span> <span class="fl">110</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">myf</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>        <span class="co"># compute a value</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6561005</span>
<span class="r-in"><span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu">myf</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">0</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span>    <span class="co"># get a matrix of values</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## h from parameters</span></span>
<span class="r-in"><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu">pcarma_h_lazy</span><span class="op">(</span><span class="va">testphi</span>, <span class="va">testtheta</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">h</span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>           <span class="co"># a scalar</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4027625</span>
<span class="r-in"><span class="va">h1</span> <span class="op">&lt;-</span> <span class="fu">h</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="co"># a matrix</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## compute acvf from parameters</span></span>
<span class="r-in"><span class="op">(</span> <span class="va">acfsys</span> <span class="op">&lt;-</span> <span class="fu">pcarma_acvf_system</span><span class="op">(</span><span class="va">testphi</span>, <span class="va">testtheta</span>, <span class="va">si2</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]       [,3]       [,4] [,5]       [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.0000000  0.0000000 -0.8100000  0.0000000    0  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.0000000  1.0000000  0.0000000 -0.4972376    0 -0.4972376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.0000000 -0.8100000  1.0000000  0.0000000    0  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -0.4972376  0.0000000 -0.4972376  1.0000000    0  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  0.0000000  0.0000000  0.0000000 -0.8100000    1  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,]  0.0000000 -0.4972376 -0.4972376  0.0000000    0  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3439000 0.1049724 0.0000000 0.0000000 0.0000000 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="va">acfvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">acfsys</span><span class="op">$</span><span class="va">A</span>, <span class="va">acfsys</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span class="r-in"><span class="va">acf1</span> <span class="op">&lt;-</span> <span class="fu"><a href="pcts_reexports.html">slMatrix</a></span><span class="op">(</span><span class="va">acfvec</span>, period <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## TODO: examples wirh q != 0</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Georgi N. Boshnakov.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

