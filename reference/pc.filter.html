<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Applies a periodic ARMA filter to a time series — pc.filter • pcts</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Applies a periodic ARMA filter to a time series — pc.filter"><meta property="og:description" content="Filter time series with a periodic arma filter.
  If whiten is FALSE (default) the function applies
  the given ARMA filter to eps (eps is often periodic
  white noise).  If whiten is TRUE the function applies
  the &amp;#8220;inverse filter&amp;#8221; to \(x\), effectively computing
  residuals."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pcts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.15.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/pcts_data.html">Importing and manipulating periodic time series data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/GeoBosh/pcts/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Applies a periodic ARMA filter to a time series</h1>
    
    <div class="hidden name"><code>pc.filter.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Filter time series with a periodic arma filter.
  If <code>whiten</code> is <code>FALSE</code> (default) the function applies
  the given ARMA filter to <code>eps</code> (<code>eps</code> is often periodic
  white noise).  If <code>whiten</code> is <code>TRUE</code> the function applies
  the “inverse filter” to \(x\), effectively computing
  residuals.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">pc.filter</span><span class="op">(</span><span class="va">model</span>, <span class="va">x</span>, <span class="va">eps</span>, seasonof1st <span class="op">=</span> <span class="fl">1</span>, from <span class="op">=</span> <span class="cn">NA</span>, whiten <span class="op">=</span> <span class="cn">FALSE</span>,
          nmean <span class="op">=</span> <span class="cn">NULL</span>, nintercept <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>the time series to be filtered, a vector.</p></dd>
<dt>eps</dt>
<dd><p>residuals, a vector or NULL.</p></dd>
<dt>model</dt>
<dd><p>the model parameters, a list with components <code>"phi"</code>,
    <code>"theta"</code>, <code>"p"</code>, <code>"q"</code>, <code>"period"</code>,
    <code>"mean"</code> and <code>"intercept"</code>, see Details.</p></dd>
<dt>seasonof1st</dt>
<dd><p>the season of the first observation (i.e., of x[1]).</p></dd>
<dt>from</dt>
<dd><p>the index from which to start filtering.</p></dd>
<dt>whiten</dt>
<dd><p>if TRUE use <code>x</code> as input and apply the inverse filter to
    produce <code>eps</code> ("whiten" <code>x</code>), if FALSE use <code>eps</code> as
    input and generate <code>x</code> ("colour" <code>eps</code>).</p></dd>
<dt>nmean</dt>
<dd>

<p>a vector of means having the length of the series, see Details.</p>
<p></p></dd>
<dt>nintercept</dt>
<dd>

<p>a vector of intercepts having the length of the series, see details.</p>
<p></p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><!-- % The function \code{pc.filter} is similar to \code{pc.armafilter} but -->
  <!-- % in addition handles mean. --></p>
<p>The model is specified by argument <code>model</code>, which is a list with
  the following components:</p><dl><dt><code>phi</code></dt>
<dd><p>the autoregression parameters,</p></dd>

    <dt><code>theta</code></dt>
<dd><p>the moving average parameters,</p></dd>

    <dt><code>p</code></dt>
<dd><p>the autoregression orders, a single number or a
      vector with one element for each season,</p></dd>

    <dt><code>q</code></dt>
<dd><p>the moving average orders, a single number or a
      vector with one element for each season,</p></dd>

    <dt><code>period</code></dt>
<dd><p>number of seasons in a cycle,</p></dd>

    <dt><code>mean</code></dt>
<dd><p>means of the seasons,</p></dd>

    <dt><code>intercept</code></dt>
<dd><p>intercepts of the seasons.</p></dd>


  
</dl><p>The relation between <code>x</code> and <code>eps</code> is assumed to be the
  following. Let
  $$y_t = x_t - mu_t$$
  be the mean corrected series, where \(mu_t\) is the mean, see below.
  The equation relating the
  mean corrected series, \(y_t=x_t - \mu_t\), and
  <code>eps</code> is the following:
    $$ y_t
    =   c_t
      + \sum_{i=1}^{p_t} \phi  _t(i)y          _{t-i}
      + \sum_{i=1}^{q_t} \theta_t(i)\varepsilon_{t-i}
      + \varepsilon_t
    $$
  where \(c_t\) is the intercept, <code>nintercept</code>. The inverse
  filter is obtained by writing this as an equation expressing
  \(\varepsilon_t\) through the remaining quantities.</p>
<p>If <code>whiten = TRUE</code>, <code>pc.filter</code> uses the above formula to
  compute the filtered values of <code>x</code> for <code>t=from,...,n</code>,
  i.e. whitening the time series if <code>eps</code> is white noise.  If
  <code>whiten = FALSE</code>, <code>eps</code> is computed, i.e. the inverse filter
  is applied <code>x</code> from <code>eps</code>, i.e. ``colouring'' <code>x</code>.
  In both cases the first few values in <code>x</code> and/or <code>eps</code> are
  used as initial values.</p>

<p>Essentially, the mean is subtracted from the series to obtain the
  mean-corrected series, say <code>y</code>. Then either <code>y</code> is filtered
  to obtain <code>eps</code> or the inverse filter is applied to obtain
  <code>y</code> from <code>eps</code>
  finally the mean is added back to <code>y</code> and the result returned.</p>
<p>The mean is formed by <code>model$mean</code> and argument <code>nmean</code>.  If
  <code>model$mean</code> is supplied it is recycled periodically to the
  length of the series <code>x</code> and subtracted from <code>x</code>. If
  argument <code>nmean</code> is supplied, it is subtracted from <code>x</code>. If
  both <code>model$mean</code> and <code>nmean</code> are supplied their sum is
  subtracted from <code>x</code>.</p>
<p>The above gives a vector <code>y</code>, \(y_t=x_t -
  \mu_t\), which is then filtered.  If the mean is
  zero, \(y_t=x_t\) in the formulas below.</p>

<p>Finally, the mean is added back, \(x_t=y_t+\mu_t\), and the new
  <code>x</code> is returned.</p>
<p>The above gives a vector <code>y</code> which is used in the filtering.  If
  the mean is zero, \(y_t=x_t\) in the formulae below.</p>
<p><code>pc.filter</code> can be used to simulate pc-arma series with the
  default value of <code>whiten=FALSE</code>. In this case <code>eps</code> is the
  input series and <code>y</code> the output.
  $$ y_t
    = c_t
      + \sum_{i=1}^{p_t} \phi  _t(i)y          _{t-i}
      + \sum_{i=1}^{q_t} \theta_t(i)\varepsilon_{t-i}
      + \varepsilon_t
    $$
  Then <code>model$mean</code> or <code>nmean</code> are added to <code>y</code> to form the
  output vector <code>x</code>.</p>
<p>Residuals corresponding to a series <code>y</code> can be obtained by
  setting <code>whiten=TRUE</code>. In this case <code>y</code> is the input series.
  The elements of the output vector <code>eps</code> are calculated by the
  formula:
  $$ \varepsilon_t
    = - c_t
      - \sum_{i=1}^{q_t} \theta_t(i)\varepsilon_{t-i}
      - \sum_{i=1}^{p_t} \phi  _t(i)y          _{t-i}
      + y_t
    $$
  There is no need in this case to restore <code>x</code> since <code>eps</code> is
  returned.</p>
<p>In both cases any necessary initial values are assumed to be already
  in the vectors. If <code>from</code> is not supplied it is chosen as the
  smallest <code>i</code> such that for all \(t\ge i\),
  <code>t-p[t]&gt;0</code> and <code>t-q[t]&gt;0</code>, i.e.  the filter will not require
  negative indices for <code>x</code> or <code>eps</code>.</p>
<p><code>pc.filter</code> calls the lower level function <code>pc.filter.xarma</code>
  to do the computation.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>The filtered series: the modified <code>x</code> if <code>whiten=FALSE</code>, the
  modified <code>eps</code> if <code>whiten=TRUE</code>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Georgi N. Boshnakov</p>
    </div>
    <div id="level">
    <h2>Level</h2>
    <p>1</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>the lower level functions
  <code><a href="pc.filter.xarma.html">pc.filter.xarma</a></code> <!-- % and \code{\link{pc.filter.arma}} -->
  which do the computations</p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Georgi N. Boshnakov.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

