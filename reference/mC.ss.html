<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Creates an environment for mc-fitting. These functions are transitory,
  hence the strange names."><title>Create environment for mc-fitting — mC.ss • pcts</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create environment for mc-fitting — mC.ss"><meta property="og:description" content="Creates an environment for mc-fitting. These functions are transitory,
  hence the strange names."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pcts</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.15.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/pcts_data.html">Importing and manipulating periodic time series data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/GeoBosh/pcts/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Create environment for mc-fitting</h1>
      
      <div class="d-none name"><code>mC.ss.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates an environment for mc-fitting. These functions are transitory,
  hence the strange names.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">mC.ss</span><span class="op">(</span><span class="va">spec</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">xx.ss</span><span class="op">(</span><span class="va">period</span>, <span class="va">type.eigval</span>, <span class="va">n.root</span>, <span class="va">eigabs</span>, <span class="va">eigsign</span>, <span class="va">co_r</span>, <span class="va">co_arg</span>, 
      init <span class="op">=</span> <span class="cn">NULL</span>, len.block <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">mo.col</span>, generators <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>spec</dt>
<dd><p>a model, an object of class mcSpec.</p></dd>
<dt>...</dt>
<dd><p>further arguments to be passed on to <code>xx.ss</code>.</p></dd>
<dt>period</dt>
<dd><p>the number of seasons.</p></dd>
<dt>type.eigval</dt>
<dd><p>types of the eigenvalues, a character vector with
      elements "r" or "cp", see Details.</p></dd>
<dt>n.root</dt>
<dd><p>number of roots. Currently the dimension of the matrix
      is set to this.</p></dd>
<dt>eigabs</dt>
<dd><p>The absolute values/moduli of the eigenvalues, numeric vector.</p></dd>
<dt>eigsign</dt>
<dd><p>The signs/moduli of the eigenvalues.</p></dd>
<dt>co_r</dt>
<dd><p>similar to <code>eigabs</code> but for the co parameters.</p></dd>
<dt>co_arg</dt>
<dd><p>similar to <code>eigsign</code> but for the co parameters.</p></dd>
<dt>init</dt>
<dd><p>initial values, see Details.</p></dd>
<dt>len.block</dt>
<dd><p>lengths of Jordan blocks.</p></dd>
<dt>mo.col</dt>
<dd><p>last non-zero column in the top of the matrix.</p></dd>
<dt>generators</dt>
<dd><p>~~ TODO: describe this argument. ~~</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>mC.ss</code> takes the specification of the model as an object of
  class mcSpec and calls <code>xx.ss</code>.</p>
<p>Basically, the value returned by these functions is an extended
  model specification together with an environment which can be used for
  fitting the model, exploring the results and trying various things.
  This may be used for getting better understanding of the model and the
  optimisation routines.</p>
<p>The result of both functions is a list, containing several functions
  and an environment. The environment (element <code>env</code>) is the most
  important element since it allows access to everything in the model
  environment. The function elements of the list are simply a
  convenience.</p>
<p>Several functions in <code>env</code> are available for fitting the
  model. Currently these are <code>minim</code>, <code>minimBB</code> and
  <code>minimBBlu</code>. The first argument of all these functions is a time
  series to which the model is to be fitted. By default, a conditional
  likelihood is being optimised. To base the optimisation on conditional
  sum of squares, set argument <code>CONDLIK</code> to FALSE.  The remaining
  arguments in a call to any of the above functions are passed on to the
  corresponding optimisation routine (whose help page should be
  consulted for details).</p>
<p><code>minim</code> uses the core <span style="R">R</span> function <code>optim</code>.
  <code>minimBB</code> and <code>minimBBlu</code> use <code>BBoptim</code> from package
  <code>BB</code>. They result is a list, as returned by the corresponding
  optimisation function with the optimal parameters  in element
  <code>par</code>. The elements of this vector are named to help somewhat in
  its interpretation but complete information about the fitted model can
  be obtained from the environment.</p>
<p>Firstly, at the end of the optimisation, the optimal parameters and
  other information are stored in <code>env</code>. If the same call (maybe
  with modified instructions for the optimisation) is repeated, these
  parameters will be used as initial values for a new optimisation
  run. This may be useful, for example, if the previous run didn't
  converge.</p>
<p>Secondly, properties of the fitted model and more useful
  representations can be obtained using functions in the environment or
  the convinience functions in the list returned by <code>xx.ss</code>.</p>
<p><code>optparam2mcparam</code> converts a vector of parameters into the
  more familiar filter representation, where the i-th row contains the
  coefficients for the i-th season. This function takes one argument the
  vector of parameters, e.g. the one returned by the fitting
  functions. It updates a number of variables in <code>env</code>, computes
  the filter representation of the model and stores it in
  <code>wrkmodel</code>. It returns NULL.
  This function may be used for exploratory purposes or to set new
  values for the parameters, e.g. to be used as starting values for a
  new optimisation run.</p>
<p><code>mcparam2optparam</code> does the opposite. It converts the current
  model in <code>env</code> to a vector of parameter. This function does not
  have arguments.</p>
<p><code>mclik</code> computes the value of the conditional likelihood for
  given parameters. Its first argument is a time series, the second is a
  vector of parameters and the third is a vector of innovations. Only
  the first argument is compulsory. If <code>param</code> is not supplied, the
  current parameters in <code>env</code> are used. Otherwise, they are updated
  with the new parameters and then used. The innovations default to the
  zero vector.
  <code>mcss</code> is similar but computes the conditional sum of squares.</p>
<p><strong>Argument <code>init</code></strong> can be used to provide initial
  values. If it is missing or NULL, random initial values are generated
  for the free parameters.
  <code>init</code> may also be a numeric vector suitable for the call
  <code>optparam2mcparam(init)</code>, see above. This vector would typically
  come from a previous optimisation run.</p>
<p><code>init</code> may also be a list with elements <code>"eigabs"</code>,
  <code>"eigsign"</code>, <code>"co_r"</code>, <code>"co_abs"</code>. These components
  have the same meaning as the corresponding arguments of <code>xx.ss</code>.</p>
<p><strong>TODO: more is needed here!</strong></p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following components:</p>
<dl><dt>fmcss</dt>
<dd><p>a function to compute the sum of squares for a model.</p></dd>
<dt>fparamvec</dt>
<dd><p>a function to convert mc-parameters to optimisation
      parameters.</p></dd>
<dt>fmcparam</dt>
<dd><p>a function to convert optimisation parameters to
      mc-parameters.</p></dd>
<dt>env</dt>
<dd><p>an object of class <code>environment</code></p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Boshnakov GN, Iqelan BM (2009).
“Generation of time series models with given spectral properties.”
<em>J. Time Series Anal.</em>, <b>30</b>(3), 349--368.
ISSN 0143-9782, doi: <a href="https://doi.org/10.1111/j.1467-9892.2009.00617.x" class="external-link">10.1111/j.1467-9892.2009.00617.x</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Georgi N. Boshnakov</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>xx.ss</code> which is called by <code>mC.ss</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># test0 roots</span></span>
<span class="r-in"><span class="va">spec.coz2</span> <span class="op">&lt;-</span> <span class="fu">mcompanion</span><span class="fu">::</span><span class="fu"><a href="https://geobosh.github.io/mcompanion/reference/mcSpec.html" class="external-link">mcSpec</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fl">5</span>, mo <span class="op">=</span> <span class="fl">4</span>, root1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">spec.coz2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class "mcSpec"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "dim":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "mo":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "ev.type":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "r" "r" "r" "r" "r"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "co.type":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> character(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "order":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "n.root":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "ev.abs":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "ev.arg":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "block.length":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "co.abs":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   NA   NA    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   NA   NA    1    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   NA   NA    0    1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   NA   NA    0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "co.arg":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   NA   NA    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   NA   NA    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   NA   NA    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   NA   NA    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "mo.col":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "F0bot":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="va">xxcoz2a</span> <span class="op">&lt;-</span> <span class="fu">mC.ss</span><span class="op">(</span><span class="va">spec.coz2</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## test0 roots</span></span>
<span class="r-in"><span class="va">spec.coz4</span> <span class="op">&lt;-</span> <span class="fu">mcompanion</span><span class="fu">::</span><span class="fu"><a href="https://geobosh.github.io/mcompanion/reference/mcSpec.html" class="external-link">mcSpec</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fl">5</span>, mo <span class="op">=</span> <span class="fl">4</span>, root1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">xxcoz4a</span> <span class="op">&lt;-</span> <span class="fu">mC.ss</span><span class="op">(</span><span class="va">spec.coz4</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Georgi N. Boshnakov.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

